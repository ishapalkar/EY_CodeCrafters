services:
  # Main backend service running all microservices
  - type: web
    name: ey-codecrafters-backend
    runtime: python
    buildCommand: pip install -r backend/requirements.txt
    startCommand: python backend/start_all_services.py
    envVars:
      # LLM Configuration
      - key: LLM_PROVIDER
        value: groq
      - key: GEMINI_API_KEY
        sync: false
      - key: GROQ_API_KEY
        sync: false
      - key: LANGSMITH_API_KEY
        sync: false
      
      # Redis
      - key: REDIS_URL
        sync: false
      
      # Vertex AI
      - key: VERTEX_PROJECT_ID
        value: ey-codecrafters
      - key: VERTEX_LOCATION
        value: asia-south1
      - key: VERTEX_MODEL
        value: gemini-2.5-flash
      - key: VERTEX_ENABLED
        value: true
      - key: VERTEX_MAX_TOKENS
        value: 1024
      - key: VERTEX_TEMPERATURE
        value: 0.7
      - key: VERTEX_TOP_P
        value: 0.95
      - key: VERTEX_TIMEOUT
        value: 30
      
      # Google Cloud Credentials (you'll need to set this)
      - key: GOOGLE_APPLICATION_CREDENTIALS
        sync: false
      
      # Inventory Service
      - key: INVENTORY_SERVICE_URL
        value: http://localhost:8001
      - key: INVENTORY_TIMEOUT
        value: 5
      
      # Payment Gateway
      - key: RAZORPAY_KEY_ID
        sync: false
      - key: RAZORPAY_KEY_SECRET
        sync: false
      
      # Telegram
      - key: TELEGRAM_BOT_TOKEN
        sync: false
      
      # Supabase (optional - if used)
      - key: SUPABASE_URL
        sync: false
      - key: SUPABASE_ANON_KEY
        sync: false
      - key: SUPABASE_SERVICE_ROLE_KEY
        sync: false
      - key: FEATURE_SUPABASE_READ
        value: false
      - key: FEATURE_SUPABASE_WRITE
        value: false
      
      # Real agents flag
      - key: USE_REAL_AGENTS
        value: true
